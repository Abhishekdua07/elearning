{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% include 'head_css.html' %}
{% include 'javascript.html' %}
{% load static %}

{% block content %}
  {% include 'breadcrumb.html' %}
  {% include "announcement.html"%}
  <!-- Chapter css is in course core css -->
  {% comment %} <link href="{% static "css/course.css" %}" rel="stylesheet"/> {% endcomment %}
  <script src="{% static "js/tinymce/jquery.tinymce.min.js" %}"></script>
  <script src="{% static "js/tinymce/tinymce.min.js" %}"></script> 
  <script>tinymce.init({
    selector: 'lesson', resize: false
  });
  </script>
  

  <div class="container">
    <div class="row">
      <div class="col-md-6 chapter-text-input">
        <form method='POST' action=''>
          {% csrf_token %}
          {{ add_txt_form|crispy }}
         
          <input class='btn btn-primary' type='submit' name="add_text" value='Add text'/>
        </form>
      </div>

      <div class="col-md-3">
        <form method='POST' action=''>
          {% csrf_token %}
          {{ add_link_form|crispy }}
          <input class='btn btn-primary' type='submit' name="add_link" value='Add YouTube video link'/>
        </form>
      </div>

      

      <div class="col-md-3">
        <form method='POST' action='' enctype="multipart/form-data">
          {% csrf_token %}
          {{ file_upload_form|crispy }} 
          <input class='btn btn-primary' type='submit' name="add_file" value='Add File'/>
        </form>
      </div>
    </div>

    <div class="col-md-3">
        <form method='POST' action=''>
          {% csrf_token %}
          {{ add_gdlink_form|crispy }}
          <input class='btn btn-primary' type='submit' name="add_gdlink" value='Add google drive video link'/>
        </form>
    </div>

    <!-- Chapter text row -->
    <div class="row">
      {% if queryset_txt_block %}
        <table class="table table-bordered generic-table scroll">
          <thead>
          <tr>
            <th>Lessons</th>
            <th>Date created</th>
            <th>Actions</th>
          </tr>
          </thead>
          {% for instance in queryset_txt_block %}
            <tr>
              <td class="col-md-8">{{ instance.lesson|safe }}</td>
              <td class="col-md-2">{{ instance.date_created }}</td>
              <td class="col-md-2">
                <a href="{% url 'edit_txt_webinar' webinar_name slug instance.id %}">
                  <input class='btn btn-primary btn-sm' type='submit' value='Edit Lesson'/>
                </a>
                <a href="{% url 'delete_txt_webinar' instance.id %}">
                  <input class='btn btn-primary btn-sm' type='submit' value='Delete Lesson'/>
                </a>
              </td>
            </tr>
          {% endfor %}
        </table>
      {% endif %}
    </div>

    <!-- Link row -->
    <div class="row">
      {% if queryset_yt_link %}
        <table class="table table-bordered generic-table scroll_table">
          <thead>
          <tr>
            <th>Link</th>
            <th>Date created</th>
            <th>Actions</th>
          </tr>
          </thead>
          {% for instance in queryset_yt_link %}
            <tr>
              <td class="col-md-8">{{ instance.link }}</td>
              <td class="col-md-2">{{ instance.date_created }}</td>
              <td class="col-md-2">
                <a href="{% url 'edit_link_webinar' webinar_name slug instance.id %}">
                  <input class='btn btn-primary btn-sm' type='submit' value='Edit Link'/>
                </a>
                <a href="{% url 'delete_link_webinar' instance.id %}">
                  <input class='btn btn-primary btn-sm' type='submit' value='Delete Link'/>
                </a>
              </td>
            </tr>
          {% endfor %}
        </table>
      {% endif %}
    </div>
  


    <!-- File row -->
    <div class="row">
      {% if queryset_files %}
        <table class="table table-bordered generic-table scroll_table">
          <thead>
          <tr>
            <th>File</th>
            <th>Date created</th>
            <th>Actions</th>
          </tr>
          </thead>
          {% for instance in queryset_files %}
            <tr>
              <td class="col-md-8">
              <a href='{{ instance.file.url }}'>{{ instance.file }}</a>
              </td>
              <td class="col-md-2">{{ instance.date_created }}</td>
              <td class="col-md-2">
                <a href="{% url 'delete_file_webinar' instance.id %}">
                  <input class='btn btn-primary btn-sm' type='submit' value='Delete File'/>
                </a>
              </td>
            </tr>
          {% endfor %}
        </table>
      {% endif %}
    </div>
  </div>


  <div class="row">
      {% if queryset_gdlink %}
        <table style="width:76%;" align="center" class="table table-bordered generic-table scroll_table">
          <thead>
          <tr>
            <th>GDLink</th>
            <th>Date created</th>
            <th>Actions</th>
          </tr>
          </thead>
          {% for instance in queryset_gdlink %}
            <tr>
              <td class="col-md-8">{{ instance.link }}</td>
              <td class="col-md-2">{{ instance.date_created }}</td>
              <td class="col-md-2">
                <a href="{% url 'edit_gdlink_webinar' webinar_name slug instance.id %}">
                  <input class='btn btn-primary btn-sm' type='submit' value='Edit Link'/>
                </a>
                <a href="{% url 'delete_gdlink_webinar' instance.id %}">
                  <input class='btn btn-primary btn-sm' type='submit' value='Delete Link'/>
                </a> 
              </td>
            </tr>
          {% endfor %}
        </table>
      {% endif %}
  </div>

  <div class="main-comment-section">
    <div class="container-fluid mt-2">
      <div class="form-group row">
        <form method="post" class="comment-form" action=".">
          {% csrf_token %}
          {{ comment_form.as_p }}
          <input type="submit" value="Submit" class="btn btn-outline-success">
        </form>
      </div>
    </div>
    {{ comments.count }} Comment{{ comments|pluralize }}
    {% for comment in comments %}
      <blockquote class="blockquote">
        <p class="mb-0"><small>{{ comment.content }}</small></p>
        <footer class="blockquote-footer"><small>by <cite title="Source Title">{{ comment.user|capfirst }}</cite></small>
          <button type="button" name="button" class="reply-btn btn btn-outline-dark btn-sm ml-2">Reply</button>
        </footer>
      </blockquote>

      <div class="replied-comments container mt-2" style="display:none;">
        {% for reply in comment.replies.all %}
        <blockquote class="blockquote">
          <p class="mb-0"><small>{{ reply.content }}</small></p>
          <footer class="blockquote-footer"><small>by <cite title="Source Title">{{ reply.user|capfirst }}</cite></small>
        </footer>
        </blockquote>
        {% endfor %}
        <div class="form-group row">
          <form method="post" class="reply-form" action=".">
            {% csrf_token %}
            <input type="hidden" name="comment_id" value="{{ comment.id }}">
            {{ comment_form.as_p }}
            {% if request.user.is_authenticated %}
              <input type="submit" value="Submit" class="btn btn-outline-success">
            {% else %}
              <input type="submit" value="Submit" class="btn btn-outline-success" disabled>
            {% endif %}
          </form>
        </div>
      </div>
    {% endfor %}
  </div>


{% endblock %}